/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
//package guardarinformacion;
import java.io.BufferedReader;
 import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Scanner;
import java.util.logging.Level;
import java.util.logging.Logger;
 public class GuardarInformacion {
 private static final String FILENAME = "C:\\Users\\victor\\Documents\\datos.txt";
 public static void main(String[] args) throws Exception {
 try {
     int puerto=Integer.parseInt(args[0]);
     
     ServerSocket ss = new ServerSocket(puerto);
     Socket s = ss.accept();
     
     ObjectOutputStream salida = new ObjectOutputStream(s.getOutputStream());
     ObjectInputStream entrada = new ObjectInputStream(s.getInputStream());
     
     
     
     
     BufferedWriter bw = null;
     FileWriter fw = null;
     BufferedReader br = null;
     try {
         
         fw = new FileWriter(FILENAME);
         bw = new BufferedWriter(fw);
         
         int ch;
         
         while((ch= (int)entrada.readObject())!=1){
             if(ch !='%' ){
                 bw.write(ch);
                 bw.flush();
                 processChar((char)ch);
                 
             }else{
                 bw.close();
                 fw.close();
                 
             }
             
         }
         
         
         
     } catch (IOException e) {
         e.printStackTrace();
     } finally {
         try {
             if (bw != null)
                 bw.close();
             if (fw != null)
                 fw.close();
         } catch (IOException ex) {
             ex.printStackTrace();
         }
     }
 } catch (IOException ex) {
         Logger.getLogger(GuardarInformacion.class.getName()).log(Level.SEVERE, null, ex);
 }
 }
 private static void processChar(char c) throws IOException{
    System.out.println("Procesando:" +c);
 }
 
 }
